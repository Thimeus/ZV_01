<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zielvereinbarungs-Datenbank | BERUFLICHE BILDUNG BREMERHAVEN</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --primary-color: #6b6557;
            --accent-color: #ff8533;
            --bg-light: #f8f9fa;
            --bg-white: #ffffff;
            --text-dark: #333333;
            --gray-light: #e9ecef;
            --gray-medium: #adb5bd;
            --gray-dark: #6c757d;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
            --border-radius: 8px;
            --transition: all 0.3s ease;
            --header-height: 100px;
            --sidebar-width: 280px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Arial, sans-serif;
        }

        body {
            background-color: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.6;
            padding-top: var(--header-height);
            overflow-x: hidden;
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: var(--header-height);
            display: flex;
            align-items: center;
            padding: 0 20px;
            background-color: #D3D3D3;
            border-bottom: 1px solid #c0c0c0;
            z-index: 1000;
            justify-content: space-between;
        }

        .logo-container {
            display: flex;
            align-items: center;
        }

        .logo-image {
            height: 60px;
            transition: transform 0.3s ease;
        }

        .logo-image:hover {
            transform: scale(1.05);
        }

        .headline-container {
            flex-grow: 1;
            text-align: center;
            padding-right: 20px;
        }

        .headline {
            font-size: 28px;
            color: var(--text-dark);
            font-weight: normal;
        }

        /* Search */
        .search-container {
            margin-left: auto;
            position: relative;
            width: 300px;
        }

        .search-container input {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid var(--gray-medium);
            border-radius: 30px;
            font-size: 15px;
            transition: var(--transition);
            background: var(--bg-white);
        }

        .search-container input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(255, 133, 51, 0.2);
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray-dark);
        }

        /* Main Layout */
        .main-container {
            display: flex;
            min-height: calc(100vh - var(--header-height));
        }

        /* Sidebar Navigation */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--bg-white);
            border-right: 1px solid var(--gray-light);
            padding: 20px 0;
            position: fixed;
            left: 0;
            top: var(--header-height);
            height: calc(100vh - var(--header-height));
            overflow-y: auto;
            transition: var(--transition);
            z-index: 100;
        }

        .sidebar.collapsed {
            width: 60px;
            overflow: visible;
        }

        .nav-toggle {
            position: absolute;
            right: -15px;
            top: 20px;
            background: var(--accent-color);
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            cursor: pointer;
            box-shadow: var(--shadow);
            z-index: 101;
        }

        .nav-section {
            margin-bottom: 20px;
        }

        .nav-header {
            padding: 10px 20px;
            font-weight: 600;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            cursor: pointer;
        }

        .nav-header i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        .nav-header .section-title {
            transition: var(--transition);
        }

        .sidebar.collapsed .nav-header .section-title {
            display: none;
        }

        .nav-items {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .nav-section.active .nav-items {
            max-height: 500px;
        }

        .nav-item {
            padding: 8px 20px 8px 50px;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
        }

        .sidebar.collapsed .nav-item {
            padding-left: 20px;
        }

        .nav-item:hover {
            background-color: var(--gray-light);
            color: var(--accent-color);
        }

        .nav-item.active {
            background-color: rgba(255, 133, 51, 0.1);
            color: var(--accent-color);
            font-weight: 500;
        }

        .nav-item.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background-color: var(--accent-color);
        }

        .sidebar.collapsed .nav-item span {
            display: none;
        }

        .sidebar.collapsed .nav-item:hover {
            position: relative;
        }

        .sidebar.collapsed .nav-item:hover span {
            display: block;
            position: absolute;
            left: 60px;
            top: 0;
            background: var(--bg-white);
            padding: 8px 15px;
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
            box-shadow: var(--shadow);
            white-space: nowrap;
            border-left: 4px solid var(--accent-color);
            z-index: 100;
        }

        /* Content Area */
        .content-area {
            flex-grow: 1;
            padding: 30px;
            margin-left: var(--sidebar-width);
            transition: var(--transition);
        }

        .sidebar.collapsed + .content-area {
            margin-left: 60px;
        }

        .content-section {
            background: var(--bg-white);
            border-radius: var(--border-radius);
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }

        .section-header {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--gray-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .section-title {
            font-size: 1.5rem;
            color: var(--primary-color);
            font-weight: 600;
        }

        .section-actions {
            display: flex;
            gap: 10px;
        }

        .action-button {
            background: var(--gray-light);
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: var(--transition);
        }

        .action-button:hover {
            background: var(--gray-medium);
        }

        .action-button.primary {
            background: var(--accent-color);
            color: white;
        }

        .action-button.primary:hover {
            background: #e67021;
        }

        /* Content Cards */
        .content-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .card {
            background: var(--bg-white);
            border-radius: var(--border-radius);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            padding: 20px;
            transition: var(--transition);
            border: 1px solid var(--gray-light);
        }

        .card:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .card-header {
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .card-body {
            color: var(--gray-dark);
        }

        .card-footer {
            margin-top: 15px;
            display: flex;
            justify-content: flex-end;
        }

        /* Content Details */
        .content-details {
            padding: 20px;
            background: var(--bg-white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .detail-header {
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--gray-light);
        }

        .detail-title {
            font-size: 1.4rem;
            color: var(--primary-color);
        }

        .detail-subtitle {
            font-size: 1.1rem;
            color: var(--gray-dark);
            margin-top: 5px;
        }

        .detail-content {
            line-height: 1.8;
        }

        .detail-section {
            margin-bottom: 20px;
        }

        .detail-section-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .detail-list {
            padding-left: 20px;
        }

        .detail-list li {
            margin-bottom: 5px;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--gray-medium);
            border-radius: 4px;
            font-size: 16px;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(255, 133, 51, 0.1);
        }

        .form-check {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .form-check-input {
            margin-right: 10px;
        }

        textarea.form-control {
            min-height: 100px;
            resize: vertical;
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--gray-light);
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: var(--transition);
            margin-right: 5px;
        }

        .tab.active {
            border-bottom-color: var(--accent-color);
            color: var(--accent-color);
            font-weight: 500;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Responsive Design */
        @media (max-width: 992px) {
            .content-cards {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                width: 250px;
            }

            .sidebar.mobile-active {
                transform: translateX(0);
            }

            .content-area {
                margin-left: 0;
            }

            .sidebar.collapsed + .content-area {
                margin-left: 0;
            }

            .mobile-nav-toggle {
                display: block;
                position: fixed;
                left: 20px;
                top: calc(var(--header-height) + 20px);
                z-index: 1000;
                background: var(--accent-color);
                width: 40px;
                height: 40px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                color: white;
                cursor: pointer;
                box-shadow: var(--shadow);
            }

            .header {
                padding: 0 10px;
            }

            .logo-image {
                height: 40px;
            }

            .headline {
                font-size: 20px;
            }

            .search-container {
                width: 180px;
            }
        }

        @media (max-width: 576px) {
            .content-cards {
                grid-template-columns: 1fr;
            }

            .header {
                height: 80px;
            }

            .content-area {
                padding: 20px 15px;
            }

            .headline-container {
                display: none;
            }
        }

        /* Loader */
        .loader {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 200px;
        }

        .loader::after {
            content: "";
            width: 40px;
            height: 40px;
            border: 4px solid var(--gray-light);
            border-top-color: var(--accent-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--bg-white);
            padding: 15px 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 10px;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 9999;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .toast.success {
            border-left: 4px solid #28a745;
        }

        .toast.error {
            border-left: 4px solid #dc3545;
        }

        .toast.info {
            border-left: 4px solid #17a2b8;
        }

        .toast i {
            font-size: 1.5rem;
        }

        .toast.success i {
            color: #28a745;
        }

        .toast.error i {
            color: #dc3545;
        }

        .toast.info i {
            color: #17a2b8;
        }

        /* Debug-Overlay */
        .debug-overlay {
            position: fixed;
            bottom: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            border-radius: 4px;
            font-size: 12px;
            z-index: 9999;
            max-width: 300px;
            max-height: 150px;
            overflow: auto;
        }

        /* Font Styling */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 600;
            line-height: 1.3;
        }

        h1 { font-size: 2rem; }
        h2 { font-size: 1.75rem; }
        h3 { font-size: 1.5rem; }
        h4 { font-size: 1.25rem; }
        h5 { font-size: 1.1rem; }
        h6 { font-size: 1rem; }

        a {
            color: var(--accent-color);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        /* Utility Classes */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .d-flex { display: flex; }
        .align-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .mt-10 { margin-top: 10px; }
        .mt-20 { margin-top: 20px; }
        .mb-10 { margin-bottom: 10px; }
        .mb-20 { margin-bottom: 20px; }
        .p-20 { padding: 20px; }
    </style>
</head>
<body>
    <!-- Header from BBB_Kopfzeile_basic -->
    <header class="header">
        <div class="logo-container">
            <img src="https://cdn.jsdelivr.net/gh/Thimeus/BBB@main/logo_bbb_1.png" alt="Berufliche Bildung Bremerhaven Logo" class="logo-image">
        </div>
        <div class="headline-container">
            <h1 class="headline">Zielvereinbarungs-Datenbank</h1>
        </div>
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="Suchen...">
            <i class="fas fa-search search-icon"></i>
        </div>
    </header>

    <!-- Mobile Navigation Toggle -->
    <div class="mobile-nav-toggle" id="mobileNavToggle">
        <i class="fas fa-bars"></i>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar" id="sidebar">
            <div class="nav-toggle" id="navToggle">
                <i class="fas fa-chevron-left" id="navToggleIcon"></i>
            </div>

            <div class="nav-section active" data-section="leitfaden">
                <div class="nav-header">
                    <i class="fas fa-book"></i>
                    <span class="section-title">Leitfaden</span>
                </div>
                <div class="nav-items">
                    <div class="nav-item active" data-content="einfuehrung">
                        <span>Einführung</span>
                    </div>
                    <div class="nav-item" data-content="struktur">
                        <span>Struktur der Zielvereinbarung</span>
                    </div>
                    <div class="nav-item" data-content="hinweise">
                        <span>Wichtige Hinweise</span>
                    </div>
                </div>
            </div>

            <div class="nav-section" data-section="textbausteine">
                <div class="nav-header">
                    <i class="fas fa-tasks"></i>
                    <span class="section-title">Textbausteine</span>
                </div>
                <div class="nav-items">
                    <div class="nav-item" data-content="arbeitsverhalten">
                        <span>Arbeitsverhalten</span>
                    </div>
                    <div class="nav-item" data-content="soziale-kompetenzen">
                        <span>Soziale Kompetenzen</span>
                    </div>
                    <div class="nav-item" data-content="methodische-kompetenzen">
                        <span>Methodische Kompetenzen</span>
                    </div>
                    <div class="nav-item" data-content="schulische-kompetenzen">
                        <span>Schulische Kompetenzen</span>
                    </div>
                    <div class="nav-item" data-content="lebenspraktische-fertigkeiten">
                        <span>Lebenspraktische Fertigkeiten</span>
                    </div>
                    <div class="nav-item" data-content="interkulturelle-kompetenzen">
                        <span>Interkulturelle Kompetenzen</span>
                    </div>
                    <div class="nav-item" data-content="it-medienkompetenz">
                        <span>IT- und Medienkompetenz</span>
                    </div>
                    <div class="nav-item" data-content="andere-kompetenzen">
                        <span>Andere Kompetenzbereiche</span>
                    </div>
                </div>
            </div>

            <div class="nav-section" data-section="umsetzung">
                <div class="nav-header">
                    <i class="fas fa-cogs"></i>
                    <span class="section-title">Umsetzung</span>
                </div>
                <div class="nav-items">
                    <div class="nav-item" data-content="grundlagen">
                        <span>Grundlagen der Förderplanung</span>
                    </div>
                    <div class="nav-item" data-content="schritte">
                        <span>Schritte der Förderplanung</span>
                    </div>
                    <div class="nav-item" data-content="dokumentation">
                        <span>Dokumentation</span>
                    </div>
                    <div class="nav-item" data-content="zielvereinbarung">
                        <span>Zielvereinbarung in kleinen Schritten</span>
                    </div>
                    <div class="nav-item" data-content="praxisbeispiele">
                        <span>Praxisbeispiele</span>
                    </div>
                    <div class="nav-item" data-content="reflexion">
                        <span>Reflexion und Anpassung</span>
                    </div>
                </div>
            </div>

            <div class="nav-section" data-section="vorlagen">
                <div class="nav-header">
                    <i class="fas fa-file-alt"></i>
                    <span class="section-title">Vorlagen</span>
                </div>
                <div class="nav-items">
                    <div class="nav-item" data-content="formulare">
                        <span>Zielvereinbarungsformular</span>
                    </div>
                    <div class="nav-item" data-content="beispiel">
                        <span>Beispiel-Zielvereinbarung</span>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Content Area -->
        <div class="content-area" id="contentArea">
            <div class="content-section">
                <div class="section-header">
                    <h2 class="section-title">Willkommen zur Zielvereinbarungs-Datenbank</h2>
                    <div class="section-actions">
                        <button class="action-button"><i class="fas fa-download"></i> Exportieren</button>
                        <button class="action-button primary"><i class="fas fa-print"></i> Drucken</button>
                    </div>
                </div>
                <p>Diese Datenbank bietet Ihnen Zugriff auf strukturierte Informationen und Hilfsmittel zur professionellen Förderplanung. Navigieren Sie durch die verschiedenen Bereiche, um Leitfäden, Textbausteine, Umsetzungshilfen und Vorlagen zu finden.</p>

                <div class="content-cards mt-20">
                    <div class="card">
                        <div class="card-header">Leitfaden</div>
                        <div class="card-body">
                            Grundlegende Informationen und Anleitung zur Erstellung von Zielvereinbarungen in der Förderplanung.
                        </div>
                        <div class="card-footer">
                            <button class="action-button" onclick="navigateTo('leitfaden', 'einfuehrung')">Öffnen</button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">Textbausteine</div>
                        <div class="card-body">
                            Vorgefertigte Textbausteine für verschiedene Kompetenzbereiche, die in Zielvereinbarungen genutzt werden können.
                        </div>
                        <div class="card-footer">
                            <button class="action-button" onclick="navigateTo('textbausteine', 'arbeitsverhalten')">Öffnen</button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">Umsetzungshilfen</div>
                        <div class="card-body">
                            Praktische Anleitungen und Schritte zur Umsetzung der Förderplanung mit konkreten Beispielen.
                        </div>
                        <div class="card-footer">
                            <button class="action-button" onclick="navigateTo('umsetzung', 'grundlagen')">Öffnen</button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">Vorlagen</div>
                        <div class="card-body">
                            Formulare und Beispiele für Zielvereinbarungen, die als Basis für eigene Dokumente dienen können.
                        </div>
                        <div class="card-footer">
                            <button class="action-button" onclick="navigateTo('vorlagen', 'formulare')">Öffnen</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="content-section" id="contentContainer">
                <div class="loader" id="contentLoader"></div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <i class="fas fa-info-circle"></i>
        <div class="toast-content">Nachricht</div>
    </div>

    <!-- Debug-Overlay (nur für Entwicklung) -->
    <!-- <div class="debug-overlay" id="debugOverlay"></div> -->

    <footer class="text-center mt-20 mb-20">
        © 2025 BERUFLICHE BILDUNG BREMERHAVEN GmbH
    </footer>

    <script>
        // Hauptdaten und ihre Struktur
        let formulierungData = null;
        let textbausteinData = null;
        let umsetzungData = null;
        let vorlageData = null;

        // Debug-Funktion
        function debug(message) {
            console.log(message);
            const debugOverlay = document.getElementById('debugOverlay');
            if (debugOverlay) {
                debugOverlay.innerHTML = message + '<br>' + debugOverlay.innerHTML;
            }
        }

        // DOM-Elemente
        const sidebar = document.getElementById('sidebar');
        const navToggle = document.getElementById('navToggle');
        const navToggleIcon = document.getElementById('navToggleIcon');
        const mobileNavToggle = document.getElementById('mobileNavToggle');
        const contentArea = document.getElementById('contentArea');
        const contentContainer = document.getElementById('contentContainer');
        const contentLoader = document.getElementById('contentLoader');
        const searchInput = document.getElementById('searchInput');
        const toast = document.getElementById('toast');

        // Funktion zum Drucken von PDF-Dokumenten
        function printPDF(pdfName) {
            // Erstelle einen Link zum PDF im selben Verzeichnis
            const pdfUrl = `./${pdfName}.pdf`;
            debug('Öffne PDF zum Drucken: ' + pdfUrl);

            // Öffne das PDF in einem neuen Tab/Fenster
            window.open(pdfUrl, '_blank');
        }

        // Event-Listener für Navigation
        navToggle.addEventListener('click', () => {
            sidebar.classList.toggle('collapsed');

            if (sidebar.classList.contains('collapsed')) {
                navToggleIcon.classList.remove('fa-chevron-left');
                navToggleIcon.classList.add('fa-chevron-right');
            } else {
                navToggleIcon.classList.remove('fa-chevron-right');
                navToggleIcon.classList.add('fa-chevron-left');
            }
        });

        mobileNavToggle.addEventListener('click', () => {
            sidebar.classList.toggle('mobile-active');
        });

        // Navigationssektionen öffnen/schließen
        document.querySelectorAll('.nav-header').forEach(header => {
            header.addEventListener('click', () => {
                const section = header.parentElement;

                // Schließe alle anderen Sektionen
                document.querySelectorAll('.nav-section').forEach(s => {
                    if (s !== section) s.classList.remove('active');
                });

                // Toggle aktuelle Sektion
                section.classList.toggle('active');
            });
        });

        // Klick auf Navigationseinträge
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', () => {
                // Aktiven Status setzen
                document.querySelectorAll('.nav-item').forEach(i => {
                    i.classList.remove('active');
                });
                item.classList.add('active');

                // Mobile Seitenleiste nach Klick schließen
                if (window.innerWidth <= 768) {
                    sidebar.classList.remove('mobile-active');
                }

                // Inhalte laden
                const section = item.closest('.nav-section').dataset.section;
                const content = item.dataset.content;
                loadContent(section, content);
            });
        });

        // Funktion zum Navigieren zu einer bestimmten Sektion und Inhalt
        function navigateTo(section, content) {
            debug('Navigiere zu: ' + section + ' / ' + content);

            // Entsprechenden Navigationspunkt aktivieren
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
                if (item.closest('.nav-section')?.dataset.section === section &&
                    item.dataset.content === content) {
                    item.classList.add('active');
                    item.closest('.nav-section').classList.add('active');
                }
            });

            // Inhalt laden
            loadContent(section, content);
        }

        // Suchfunktion
        searchInput.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            if (searchTerm.length < 3) return; // Mindestens 3 Zeichen

            performSearch(searchTerm);
        });

        function performSearch(term) {
            showToast('info', 'Suche nach: ' + term);

            // Hier würde die tatsächliche Suchlogik implementiert werden
            // Für jetzt nur eine einfache Demo:
            contentContainer.innerHTML = `
                <div class="section-header">
                    <h2 class="section-title">Suchergebnisse für "${term}"</h2>
                </div>
                <div class="search-results">
                    <p>Durchsuche alle Inhalte nach "${term}"...</p>
                    <div class="content-cards mt-20" id="searchResults">
                    </div>
                </div>
            `;

            // Demo-Suchergebnisse auf Basis der geladenen Daten
            const searchResults = document.getElementById('searchResults');
            searchResults.innerHTML = '<div class="loader"></div>';

            setTimeout(() => {
                if (!formulierungData || !textbausteinData) {
                    searchResults.innerHTML = '<p>Die Daten werden noch geladen. Bitte versuchen Sie es später erneut.</p>';
                    return;
                }

                let results = [];

                // Durchsuche formulierungData
                if (formulierungData.sectionsContent) {
                    formulierungData.sectionsContent.forEach(section => {
                        // Überprüfe Sectiontitel
                        if (section.sectionTitle.toLowerCase().includes(term)) {
                            results.push({
                                title: section.sectionTitle,
                                section: 'leitfaden',
                                content: section.sectionTitle.toLowerCase().replace(' ', '-'),
                                description: `Gefunden im Leitfaden: ${section.sectionTitle}`
                            });
                        }

                        // Durchsuche Subsections
                        if (section.subsections) {
                            section.subsections.forEach(subsection => {
                                if (subsection.subsectionTitle && subsection.subsectionTitle.toLowerCase().includes(term)) {
                                    results.push({
                                        title: subsection.subsectionTitle,
                                        section: 'leitfaden',
                                        content: 'struktur',
                                        description: `Gefunden im Leitfaden unter ${section.sectionTitle}`
                                    });
                                }

                                // Durchsuche Inhalte
                                if (subsection.content) {
                                    const contentText = subsection.content.join(' ');
                                    if (contentText.toLowerCase().includes(term)) {
                                        results.push({
                                            title: subsection.subsectionTitle || section.sectionTitle,
                                            section: 'leitfaden',
                                            content: 'hinweise',
                                            description: `Inhalt enthält den Suchbegriff: "${contentText.substring(contentText.toLowerCase().indexOf(term) - 20, contentText.toLowerCase().indexOf(term) + 20)}..."`
                                        });
                                    }
                                }
                            });
                        }
                    });
                }

                // Durchsuche textbausteinData
                if (textbausteinData.sectionsContent) {
                    textbausteinData.sectionsContent.forEach(section => {
                        // Überprüfe Sectiontitel
                        if (section.sectionTitle.toLowerCase().includes(term)) {
                            results.push({
                                title: section.sectionTitle,
                                section: 'textbausteine',
                                content: section.sectionTitle.toLowerCase().replace(' ', '-'),
                                description: `Gefunden in Textbausteinen: ${section.sectionTitle}`
                            });
                        }

                        // Durchsuche Subsections
                        if (section.subsections) {
                            section.subsections.forEach(subsection => {
                                if (subsection.subsectionTitle && subsection.subsectionTitle.toLowerCase().includes(term)) {
                                    results.push({
                                        title: subsection.subsectionTitle,
                                        section: 'textbausteine',
                                        content: section.sectionTitle.toLowerCase().replace(/\s+\d+\.\s+/, '').replace(/\s+/g, '-'),
                                        description: `Gefunden in Textbausteinen unter ${section.sectionTitle}`
                                    });
                                }

                                // Durchsuche verschiedene Inhalte
                                ['problembeschreibungen', 'grobziel', 'feinziele'].forEach(field => {
                                    if (subsection[field]) {
                                        const fieldContent = Array.isArray(subsection[field])
                                            ? subsection[field].join(' ')
                                            : subsection[field];

                                        if (fieldContent.toLowerCase().includes(term)) {
                                            results.push({
                                                title: `${subsection.subsectionTitle} - ${field}`,
                                                section: 'textbausteine',
                                                content: section.sectionTitle.toLowerCase().replace(/\s+\d+\.\s+/, '').replace(/\s+/g, '-'),
                                                description: `Gefunden in ${field}: "${fieldContent.substring(fieldContent.toLowerCase().indexOf(term) - 20, fieldContent.toLowerCase().indexOf(term) + 20)}..."`
                                            });
                                        }
                                    }
                                });
                            });
                        }
                    });
                }

                // Zeige Ergebnisse an
                if (results.length > 0) {
                    searchResults.innerHTML = '';
                    results.forEach((result, index) => {
                        if (index < 8) { // Begrenze auf 8 Ergebnisse für bessere Übersicht
                            const card = document.createElement('div');
                            card.className = 'card';
                            card.innerHTML = `
                                <div class="card-header">${result.title}</div>
                                <div class="card-body">
                                    ${result.description}
                                </div>
                                <div class="card-footer">
                                    <button class="action-button" onclick="navigateTo('${result.section}', '${result.content}')">Anzeigen</button>
                                </div>
                            `;
                            searchResults.appendChild(card);
                        }
                    });

                    if (results.length > 8) {
                        const moreInfo = document.createElement('p');
                        moreInfo.className = 'mt-20 text-center';
                        moreInfo.textContent = `${results.length - 8} weitere Ergebnisse gefunden. Bitte verfeinern Sie Ihre Suche.`;
                        searchResults.appendChild(moreInfo);
                    }
                } else {
                    searchResults.innerHTML = '<p>Keine Ergebnisse gefunden. Bitte versuchen Sie es mit anderen Suchbegriffen.</p>';
                }
            }, 500);
        }

        // Toast-Benachrichtigungen
        function showToast(type, message) {
            toast.className = 'toast ' + type;
            toast.querySelector('.toast-content').textContent = message;
            toast.classList.add('show');

            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Funktion zum Initialisieren der Tab-Funktionalität
        function initializeTabs() {
            debug('Initialisiere Tabs: ' + document.querySelectorAll('.tab').length);

            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabIndex = this.getAttribute('data-tab');
                    debug('Tab geklickt: ' + tabIndex);

                    // Aktiviere den ausgewählten Tab
                    document.querySelectorAll('.tab').forEach(t => {
                        t.classList.remove('active');
                    });
                    this.classList.add('active');

                    // Zeige den ausgewählten Tab-Inhalt
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                        if (content.getAttribute('data-tab-content') === tabIndex) {
                            content.classList.add('active');
                        }
                    });
                });
            });
        }

        // Funktion zum Initialisieren der Druck-Buttons
        function initializePrintButtons() {
            debug('Initialisiere Druck-Buttons');

            // Buttons auf der Hauptseite
            document.querySelectorAll('.action-button').forEach(button => {
                if (button.innerHTML.includes('Drucken')) {
                    button.addEventListener('click', function() {
                        // Prüfe, ob der Button sich in einer Karte auf der Hauptseite befindet
                        const card = this.closest('.card');
                        if (card) {
                            const cardHeader = card.querySelector('.card-header')?.textContent;
                            if (cardHeader) {
                                debug('Drucke PDF für: ' + cardHeader);
                                switch (cardHeader.trim()) {
                                    case 'Leitfaden':
                                        printPDF('leitfaden');
                                        return;
                                    case 'Textbausteine':
                                        printPDF('textbausteine');
                                        return;
                                    case 'Umsetzungshilfen':
                                        printPDF('umsetzung');
                                        return;
                                    case 'Vorlagen':
                                        printPDF('vorlage');
                                        return;
                                }
                            }
                        }

                        // Prüfe, ob der Button sich in einer Inhaltssektion befindet
                        const section = this.closest('.section-header')?.querySelector('.section-title')?.textContent;
                        if (section) {
                            debug('Drucke PDF für Sektion: ' + section);
                            if (section.includes('Leitfaden')) {
                                printPDF('leitfaden');
                            } else if (section.includes('Textbausteine') || section.includes('Arbeitsverhalten') || section.includes('Kompetenzen')) {
                                printPDF('textbausteine');
                            } else if (section.includes('Umsetzung') || section.includes('Förderplanung')) {
                                printPDF('umsetzung');
                            } else if (section.includes('Vorlage') || section.includes('Zielvereinbarung')) {
                                printPDF('vorlage');
                            } else {
                                window.print(); // Fallback: Drucke aktuelle Seite
                            }
                        } else {
                            window.print(); // Fallback: Drucke aktuelle Seite
                        }
                    });
                }
            });
        }

        // Inhalte laden und anzeigen
        async function loadContent(section, content) {
            debug('Lade Inhalt: ' + section + ' / ' + content);

            contentLoader.style.display = 'flex';
            contentContainer.style.opacity = '0.5';


            let html = '';

            switch(section) {
                case 'leitfaden':
                    html = renderLeitfadenContent(content);
                    break;
                case 'textbausteine':
                    html = renderTextbausteinContent(content);
                    break;
                case 'umsetzung':
                    html = renderUmsetzungContent(content);
                    break;
                case 'vorlagen':
                    html = renderVorlagenContent(content);
                    break;
                default:
                    html = '<p>Inhalt nicht gefunden</p>';
            }

            setTimeout(() => {
                contentLoader.style.display = 'none';
                contentContainer.style.opacity = '1';
                contentContainer.innerHTML = html;

                // Initialisiere Tab-Funktionalität, wenn Tabs vorhanden sind
                initializeTabs();

                // Initialisiere Druck-Buttons
                initializePrintButtons();

                // Scrolle zum Anfang des Inhalts
                contentContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 300);
        }

        // Alle Daten laden (angepasst, um formulierungData optional zu machen)
        async function loadAllData() {
            debug('Lade Daten...');

            try {
                const promises = [];


                if (!textbausteinData) {
                    promises.push(
                        fetch('./textbaustein.json')
                            .then(response => {
                                if (!response.ok) {
                                    throw new Error(`HTTP error! Status: ${response.status}`);
                                }
                                return response.json();
                            })
                            .then(data => {
                                textbausteinData = data;
                                debug('Textbausteindaten geladen');
                            })
                            .catch(error => {
                                console.error('Error loading textbausteinData:', error);
                                showToast('error', 'Fehler beim Laden der Textbaustein-Daten: ' + error.message);
                            })
                    );
                }

                if (!umsetzungData) {
                    promises.push(
                        fetch('./umsetzung.json')
                            .then(response => {
                                if (!response.ok) {
                                    throw new Error(`HTTP error! Status: ${response.status}`);
                                }
                                return response.json();
                            })
                            .then(data => {
                                umsetzungData = data;
                                debug('Umsetzungsdaten geladen');
                            })
                            .catch(error => {
                                console.error('Error loading umsetzungData:', error);
                                showToast('error', 'Fehler beim Laden der Umsetzungs-Daten: ' + error.message);
                            })
                    );
                }

                if (!vorlageData) {
                    promises.push(
                        fetch('./vorlage.json')
                            .then(response => {
                                if (!response.ok) {
                                    throw new Error(`HTTP error! Status: ${response.status}`);
                                }
                                return response.json();
                            })
                            .then(data => {
                                vorlageData = data;
                                debug('Vorlagedaten geladen');
                            })
                            .catch(error => {
                                console.error('Error loading vorlageData:', error);
                                showToast('error', 'Fehler beim Laden der Vorlagen-Daten: ' + error.message);
                            })
                    );
                }

                if (promises.length > 0) {
                    await Promise.all(promises);
                }

                return true;
            } catch (e) {
                console.error('Fehler beim Laden aller Daten:', e);
                showToast('error', 'Fehler beim Laden der Daten: ' + e.message);
                return false;
            }
        }

        // Renderfunktionen für jeden Inhaltsbereich
        function renderLeitfadenContent(content) {


            let html = '';

            switch(content) {
                case 'einfuehrung':
                    html = `
                        <div class="section-header">
                            <h2 class="section-title">Einführung: Zielvereinbarung - Gemeinsam Ziele erreichen</h2>
                            <div class="section-actions">
                                <button class="action-button primary"><i class="fas fa-print"></i> Drucken</button>
                            </div>
                        </div>
                        <div class="detail-content">
                            <p>Zielvereinbarungen sind ein zentrales Instrument in der individuellen Förderplanung. Sie dienen dazu, gemeinsam mit dem Jugendlichen oder dem Teilnehmer klare und erreichbare Ziele zu definieren. Diese Ziele orientieren sich an den Stärken und Ressourcen des Einzelnen und zielen darauf ab, positive Veränderungen im Verhalten und in den Kompetenzen zu bewirken. Eine transparente und partizipative Zielvereinbarung fördert die Motivation und Eigenverantwortung des Teilnehmers und ermöglicht es allen Beteiligten, den Fortschritt messbar zu machen und den Förderprozess aktiv zu gestalten.</p>
                        </div>
                    `;
                    break;

                case 'struktur':
                    html = `
                        <div class="section-header">
                            <h2 class="section-title">Struktur der Zielvereinbarung</h2>
                            <div class="section-actions">
                                <button class="action-button primary"><i class="fas fa-print"></i> Drucken</button>
                            </div>
                        </div>
                        <div class="detail-content">
                            <p>Eine Zielvereinbarung sollte klar strukturiert sein, um sowohl für den Betreuer als auch für den Teilnehmer verständlich und nachvollziehbar zu sein.  Sie besteht typischerweise aus folgenden Elementen:</p>
                            <ul class="detail-list mt-20">
                                <li><strong>Problembereich:</strong>  Benennung des konkreten Arbeits- oder Verhaltensbereichs, in dem eine Veränderung gewünscht oder notwendig ist (z.B. Pünktlichkeit, Arbeitsorganisation, Sozialverhalten).</li>
                                <li><strong>Problembeschreibung:</strong>  Detaillierte und beobachtbare Beschreibung des aktuellen Problems. Was genau ist das Problem?  Wie äußert es sich konkret?  Welche Auswirkungen hat es?</li>
                                <li><strong>Grobziel:</strong>  Formulierung eines übergeordneten, positiv ausgerichteten Ziels.  Was soll idealerweise erreicht werden? (z.B. „Max kommt pünktlich zur Arbeit“).</li>
                                <li><strong>Feinziele:</strong>  Konkrete, messbare, aktionsorientierte und realistische Einzelschritte, die zur Erreichung des Grobziels notwendig sind.  Sie sollen so formuliert sein, dass der Fortschritt überprüfbar ist (SMART-Kriterien).</li>
                                <li><strong>Ressourcen/Unterstützung:</strong>  Auflistung der Hilfen und Ressourcen, die der Teilnehmer benötigt, um die Ziele zu erreichen (z.B.  Gespräche, Anleitungen, Materialien, Unterstützung durch Kollegen).</li>
                                <li><strong>Überprüfungsdatum:</strong>  Festlegung eines Termins, an dem die Zielvereinbarung überprüft und der Fortschritt besprochen wird.</li>
                                <li><strong>Unterschriften:</strong>  Bestätigung der Zielvereinbarung durch Unterschrift des Teilnehmers und des Betreuers/Mitarbeiters.</li>
                            </ul>
                        </div>
                    `;
                    break;

                case 'hinweise':
                    html = `
                        <div class="section-header">
                            <h2 class="section-title">Wichtige Hinweise für die Formulierung von Feinzielen</h2>
                            <div class="section-actions">
                                <button class="action-button primary"><i class="fas fa-print"></i> Drucken</button>
                            </div>
                        </div>
                        <div class="detail-content">
                            <ul class="detail-list">
                                <li><strong>SMART-Formulierung:</strong>  Feinziele sollten SMART formuliert sein, d.h. <strong>S</strong>pezifisch, <strong>M</strong>essbar, <strong>A</strong>ktionsorientiert, <strong>R</strong>ealistisch und <strong>T</strong>erminiert.</li>
                                <li><strong>Positive Formulierung:</strong>  Ziele sollten positiv formuliert sein (Was soll erreicht werden?) und nicht negativ (Was soll vermieden werden?).</li>
                                <li><strong>Realistische Ziele setzen:</strong>  Die Feinziele müssen erreichbar sein und den Teilnehmer nicht überfordern. Kleine Schritte und Erfolgserlebnisse sind wichtig für die Motivation.</li>
                                <li><strong>Partizipation des Teilnehmers:</strong>  Der Teilnehmer sollte aktiv in die Zielvereinbarung einbezogen werden und die Ziele mitgestalten können.  Dies fördert die Eigenverantwortung und Motivation.</li>
                                <li><strong>Verständlichkeit:</strong>  Die Zielvereinbarung muss für den Teilnehmer verständlich formuliert sein.  Komplexe Formulierungen und Fachbegriffe sollten vermieden werden.</li>
                                <li><strong>Regelmäßige Überprüfung:</strong>  Die Zielvereinbarung sollte in regelmäßigen Abständen überprüft und bei Bedarf angepasst werden.  So bleibt der Förderprozess dynamisch und kann auf Veränderungen reagieren.</li>
                            </ul>
                        </div>
                    `;
                    break;

                default:
                    html = '<p>Inhalt nicht gefunden</p>';
            }

            return html;
        }


        function renderTextbausteinContent(content) {
            if (!textbausteinData) return '<p>Daten werden geladen...</p>';

            let html = '';
            let section;

            // Finde die entsprechende Sektion basierend auf dem content-Parameter
            switch(content) {
                case 'arbeitsverhalten':
                    section = textbausteinData.sectionsContent.find(s => s.sectionTitle === "1. Arbeitsverhalten");
                    break;
                case 'soziale-kompetenzen':
                    section = textbausteinData.sectionsContent.find(s => s.sectionTitle === "2. Soziale Kompetenzen");
                    break;
                case 'methodische-kompetenzen':
                    section = textbausteinData.sectionsContent.find(s => s.sectionTitle === "3. Methodische Kompetenzen");
                    break;
                case 'schulische-kompetenzen':
                    section = textbausteinData.sectionsContent.find(s => s.sectionTitle === "4. Schulische Kompetenzen");
                    break;
                case 'lebenspraktische-fertigkeiten':
                    section = textbausteinData.sectionsContent.find(s => s.sectionTitle === "5. Lebenspraktische Fertigkeiten");
                    break;
                case 'interkulturelle-kompetenzen':
                    section = textbausteinData.sectionsContent.find(s => s.sectionTitle === "6. Interkulturelle Kompetenzen");
                    break;
                case 'it-medienkompetenz':
                    section = textbausteinData.sectionsContent.find(s => s.sectionTitle === "7. IT- und Medienkompetenz");
                    break;
                case 'andere-kompetenzen':
                    section = textbausteinData.sectionsContent.find(s => s.sectionTitle === "8. Andere Kompetenzbereiche");
                    break;
                default:
                    return '<p>Textbaustein nicht gefunden</p>';
            }

            if (section) {
                html = `
                    <div class="section-header">
                        <h2 class="section-title">${section.sectionTitle}</h2>
                        <div class="section-actions">
                            <button class="action-button primary"><i class="fas fa-print"></i> Drucken</button>
                        </div>
                    </div>

                    <div class="tabs">
                        ${section.subsections.map((subsection, index) =>
                            `<div class="tab ${index === 0 ? 'active' : ''}" data-tab="${index}">${subsection.subsectionTitle}</div>`
                        ).join('')}
                    </div>
                `;

                // Tab-Inhalte
                html += section.subsections.map((subsection, index) => {
                    return `
                        <div class="tab-content ${index === 0 ? 'active' : ''}" data-tab-content="${index}">
                            <div class="detail-section">
                                <h3 class="detail-section-title">Problembeschreibungen:</h3>
                                <div class="detail-content">
                                    <p>${subsection.problembeschreibungen ? subsection.problembeschreibungen.join(' ') : 'Keine Problembeschreibung verfügbar.'}</p>
                                </div>
                            </div>

                            <div class="detail-section">
                                <h3 class="detail-section-title">Grobziel:</h3>
                                <div class="detail-content">
                                    <p>${subsection.grobziel || 'Kein Grobziel verfügbar.'}</p>
                                </div>
                            </div>

                            <div class="detail-section">
                                <h3 class="detail-section-title">Feinziele:</h3>
                                <div class="detail-content">
                                    <ul class="detail-list">
                                        ${subsection.feinziele ? subsection.feinziele.map(feinziel => `<li>${feinziel}</li>`).join('') : '<li>Keine Feinziele verfügbar.</li>'}
                                    </ul>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            return html;
        }

        function renderUmsetzungContent(content) {
            if (!umsetzungData) return '<p>Daten werden geladen...</p>';

            let html = '';
            let section;

            // Finde den relevanten Abschnitt basierend auf dem content-Parameter
            switch(content) {
                case 'grundlagen':
                    section = umsetzungData.sectionsContent.find(s => s.sectionTitle === "1. Grundlagen der Förderplanung");
                    if (section) {
                        html = `
                            <div class="section-header">
                                <h2 class="section-title">${section.sectionTitle}</h2>
                                <div class="section-actions">
                                    <button class="action-button primary"><i class="fas fa-print"></i> Drucken</button>
                                </div>
                            </div>
                            <div class="detail-content">
                                ${section.subsections.map(subsection => `
                                    <div class="detail-section">
                                        <h3 class="detail-section-title">${subsection.subsectionTitle}</h3>
                                        <p>${subsection.content.join(' ')}</p>
                                    </div>
                                `).join('')}
                            </div>
                        `;
                    }
                    break;

                case 'schritte':
                    section = umsetzungData.sectionsContent.find(s => s.sectionTitle === "2. Schritte der Förderplanung");
                    if (section) {
                        html = `
                            <div class="section-header">
                                <h2 class="section-title">${section.sectionTitle}</h2>
                                <div class="section-actions">
                                    <button class="action-button primary"><i class="fas fa-print"></i> Drucken</button>
                                </div>
                            </div>
                            <div class="detail-content">
                                ${section.subsections.map(subsection => `
                                    <div class="detail-section">
                                        <h3 class="detail-section-title">${subsection.subsectionTitle}</h3>
                                        <p>${subsection.content.join(' ')}</p>
                                    </div>
                                `).join('')}
                            </div>
                        `;
                    }
                    break;

                case 'dokumentation':
                    section = umsetzungData.sectionsContent.find(s => s.sectionTitle === "3. Dokumentation der Förderplanung");
                    if (section) {
                        html = `
                            <div class="section-header">
                                <h2 class="section-title">${section.sectionTitle}</h2>
                                <div class="section-actions">
                                    <button class="action-button primary"><i class="fas fa-print"></i> Drucken</button>
                                </div>
                            </div>
                            <div class="detail-content">
                                ${section.subsections.map(subsection => `
                                    <div class="detail-section">
                                        <h3 class="detail-section-title">${subsection.subsectionTitle}</h3>
                                        <p>${subsection.content.join(' ')}</p>
                                    </div>
                                `).join('')}
                            </div>
                        `;
                    }
                    break;

                case 'zielvereinbarung':
                    section = umsetzungData.sectionsContent.find(s => s.sectionTitle === "4. Zielvereinbarung in kleinen Schritten");
                    if (section) {
                        html = `
                            <div class="section-header">
                                <h2 class="section-title">${section.sectionTitle}</h2>
                                <div class="section-actions">
                                    <button class="action-button primary"><i class="fas fa-print"></i> Drucken</button>
                                </div>
                            </div>
                            <div class="detail-content">
                                ${section.subsections.map(subsection => `
                                    <div class="detail-section">
                                        <h3 class="detail-section-title">${subsection.subsectionTitle}</h3>
                                        <p>${subsection.content.join(' ')}</p>
                                    </div>
                                `).join('')}
                            </div>
                        `;
                    }
                    break;

                case 'praxisbeispiele':
                    section = umsetzungData.sectionsContent.find(s => s.sectionTitle === "5. Praxisbeispiele");
                    if (section) {
                        html = `
                            <div class="section-header">
                                <h2 class="section-title">${section.sectionTitle}</h2>
                                <div class="section-actions">
                                    <button class="action-button primary"><i class="fas fa-print"></i> Drucken</button>
                                </div>
                            </div>
                            <div class="detail-content">
                                <div class="detail-section">
                                    <h3 class="detail-section-title">Beispiel 1: Förderung der Selbstständigkeit</h3>
                                    <p><strong>Ausgangslage:</strong> Unterstützung bei alltäglichen Aufgaben notwendig.</p>
                                    <p><strong>Ziel:</strong> Innerhalb von drei Monaten selbstständiges Einkaufen.</p>
                                    <p><strong>Maßnahmen:</strong></p>
                                    <ul class="detail-list">
                                        <li>Schritt 1: Einkaufsliste schreiben üben.</li>
                                        <li>Schritt 2: Begleitetes Einkaufen.</li>
                                        <li>Schritt 3: Einkaufen ohne Begleitung.</li>
                                    </ul>
                                    <p><strong>Dokumentation:</strong> Fortschrittsnotizen nach jeder Einheit.</p>
                                </div>

                                <div class="detail-section">
                                    <h3 class="detail-section-title">Beispiel 2: Verbesserung der Konzentrationsfähigkeit</h3>
                                    <p><strong>Ausgangslage:</strong> Schwierigkeiten, sich länger auf eine Aufgabe zu konzentrieren.</p>
                                    <p><strong>Ziel:</strong> 20 Minuten konzentriertes Arbeiten innerhalb von vier Wochen.</p>
                                </div>
                            </div>
                        `;
                    }
                    break;

                case 'reflexion':
                    section = umsetzungData.sectionsContent.find(s => s.sectionTitle === "6. Reflexion und Anpassung");
                    if (section) {
                        html = `
                            <div class="section-header">
                                <h2 class="section-title">${section.sectionTitle}</h2>
                                <div class="section-actions">
                                    <button class="action-button primary"><i class="fas fa-print"></i> Drucken</button>
                                </div>
                            </div>
                            <div class="detail-content">
                                ${section.subsections.map(subsection => `
                                    <div class="detail-section">
                                        <h3 class="detail-section-title">${subsection.subsectionTitle}</h3>
                                        <p>${subsection.content.join(' ')}</p>
                                    </div>
                                `).join('')}
                            </div>
                        `;
                    }
                    break;

                default:
                    html = '<p>Inhalt nicht gefunden</p>';
            }

            return html;
        }

        function renderVorlagenContent(content) {
            if (!vorlageData) return '<p>Daten werden geladen...</p>';

            let html = '';

            switch(content) {
                case 'formulare':
                    html = `
                        <div class="section-header">
                            <h2 class="section-title">Zielvereinbarungsformular</h2>
                            <div class="section-actions">
                                <button class="action-button" onclick="downloadFormPDF()"><i class="fas fa-download"></i> Herunterladen</button>
                                <button class="action-button primary" onclick="printFormPDF()"><i class="fas fa-print"></i> Drucken</button>
                            </div>
                        </div>

                        <div class="detail-content">
                            <form class="p-20" id="zielvereinbarungForm">
                                <div class="form-group">
                                    <label class="form-label">Teilnehmer/in:</label>
                                    <input type="text" class="form-control" id="teilnehmerName" placeholder="Name des Teilnehmers / der Teilnehmerin">
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Datum:</label>
                                    <input type="date" class="form-control" id="datum">
                                </div>

                                <div class="form-group">
                                    <label class="form-label">1. Problembereich: (Bitte den relevanten Bereich ankreuzen)</label>
                                    ${vorlageData.formFields[0].checkboxes.map((checkbox, index) => `
                                        <div class="form-check">
                                            <input type="checkbox" class="form-check-input" id="problembereich${index}" value="${checkbox.replace('[]', '')}">
                                            <label for="problembereich${index}">${checkbox.replace('[]', '')}</label>
                                        </div>
                                    `).join('')}
                                </div>

                                <div class="form-group">
                                    <label class="form-label">2. Problembeschreibung:</label>
                                    <textarea class="form-control" id="problemBeschreibung" placeholder="Beschreiben Sie das Problem so konkret und beobachtbar wie möglich. Was genau fällt Ihnen auf? Wieso ist das problematisch?"></textarea>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">3. Grobziel:</label>
                                    <textarea class="form-control" id="grobziel" placeholder="Welches übergeordnete Ziel soll erreicht werden?"></textarea>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">4. Feinziele:</label>

                                    <div class="form-group">
                                        <label class="form-label">• Feinziel 1 (Messbar & Konkret):</label>
                                        <textarea class="form-control" id="feinziel1" placeholder="Welche konkreten, messbaren Schritte müssen unternommen werden?"></textarea>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">• Feinziel 2 (Aktion & Strategie):</label>
                                        <textarea class="form-control" id="feinziel2" placeholder="Welche Aktionen und Strategien werden angewendet?"></textarea>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">• Feinziel 3 (optional):</label>
                                        <textarea class="form-control" id="feinziel3" placeholder="Weitere Feinziele (optional)"></textarea>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">5. Ressourcen/Unterstützung:</label>
                                    <textarea class="form-control" id="ressourcen" placeholder="Welche Ressourcen oder Unterstützung benötigt der Teilnehmer?"></textarea>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">6. Überprüfungsdatum:</label>
                                    <input type="date" class="form-control" id="ueberpruefungsdatum">
                                </div>

                                <div class="d-flex justify-between mt-20">
                                    <div class="form-group" style="width: 48%;">
                                        <label class="form-label">Unterschrift Teilnehmer/in:</label>
                                        <div style="height: 80px; border: 1px dashed var(--gray-medium); border-radius: 4px;"></div>
                                    </div>

                                    <div class="form-group" style="width: 48%;">
                                        <label class="form-label">Unterschrift Mitarbeiter/in:</label>
                                        <div style="height: 80px; border: 1px dashed var(--gray-medium); border-radius: 4px;"></div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    `;
                    break;

                case 'beispiel':
                    html = `
                        <div class="section-header">
                            <h2 class="section-title">Beispiel-Zielvereinbarung: Verbesserung der Pünktlichkeit</h2>
                            <div class="section-actions">
                                <button class="action-button primary" onclick="window.print()"><i class="fas fa-print"></i> Drucken</button>
                            </div>
                        </div>

                        <div class="detail-content p-20" style="background-color: var(--bg-light); border-radius: var(--border-radius);">
                            <h3>Beispiel-Zielvereinbarung: Verbesserung der Pünktlichkeit</h3>
                            <p><strong>Teilnehmer/in: Max Mustermann</strong></p>
                            <p><strong>Datum: 15.02.2024</strong></p>
                            <p><strong>1. Problembereich: Arbeitsverhalten (Pünktlichkeit)</strong></p>
                            <p><strong>2. Problembeschreibung:</strong></p>
                            <p>Max kommt in den letzten Wochen regelmäßig zu spät zum Arbeitsbeginn. Er sollte um 8:00 Uhr mit der Arbeit beginnen, ist aber oft erst zwischen 8:15 Uhr und 8:30 Uhr an seinem Arbeitsplatz. Dies führt zu Verzögerungen im Arbeitsablauf und stört die Teamarbeit. Letzte Woche war er an 3 von 5 Tagen zu spät.</p>
                            <p><strong>3. Grobziel:</strong></p>
                            <p>Max wird seine Pünktlichkeit verbessern und regelmäßig pünktlich zum Arbeitsbeginn erscheinen.</p>
                            <p><strong>4. Feinziele:</strong></p>
                            <p><strong>- Feinziel 1 (Messbar & Konkret):</strong></p>
                            <p>Max wird in den nächsten zwei Wochen an mindestens 8 von 10 Arbeitstagen pünktlich um 8:00 Uhr mit der Arbeit beginnen.</p>
                            <p><strong>- Feinziel 2 (Aktion & Strategie):</strong></p>
                            <p>Max wird ab sofort jeden Abend seinen Wecker so stellen, dass er ausreichend Zeit hat, um pünktlich zur Arbeit zu kommen. Er wird verschiedene Weckzeiten ausprobieren, um die optimale Zeit zu finden.</p>
                            <p><strong>- Feinziel 3 (Selbstkontrolle & Reflexion):</strong></p>
                            <p>Max wird täglich nach der Arbeit kurz reflektieren, ob er pünktlich war und was ihm geholfen hat oder was ihn daran gehindert hat. Er wird seine Erkenntnisse in einem kleinen Notizbuch festhalten.</p>
                            <p><strong>5. Ressourcen/Unterstützung:</strong></p>
                            <ul>
                                <li>Regelmäßige Gespräche mit dem Sozialpädagogen/Trainer (z.B. wöchentlich), um Fortschritte zu besprechen und Unterstützung zu bieten.</li>
                                <li>Unterstützung bei der Entwicklung einer Morgenroutine, die das pünktliche Erscheinen erleichtert.</li>
                                <li>Zugang zu einem Kalender oder einer App zur Erinnerung an Arbeitsbeginn.</li>
                            </ul>
                            <p><strong>6. Überprüfungsdatum: 01.03.2024 (In zwei Wochen)</strong></p>
                            <p>Unterschrift Teilnehmer/in:</p>
                            <p>Unterschrift Mitarbeiter/in:</p>
                        </div>
                    `;
                    break;

                default:
                    html = '<p>Inhalt nicht gefunden</p>';
            }

            return html;
        }

        function downloadFormPDF() {
            const form = document.getElementById('zielvereinbarungForm');
            let formData = {};
            const checkboxes = [];

            formData['Teilnehmer/in'] = document.getElementById('teilnehmerName').value;
            formData['Datum'] = document.getElementById('datum').value;

            vorlageData.formFields[0].checkboxes.forEach((checkbox, index) => {
                if (document.getElementById(`problembereich${index}`).checked) {
                    checkboxes.push(checkbox.replace('[]', ''));
                }
            });
            formData['Problembereich'] = checkboxes.join(', ');
            formData['Problembeschreibung'] = document.getElementById('problemBeschreibung').value;
            formData['Grobziel'] = document.getElementById('grobziel').value;
            formData['Feinziel 1 (Messbar & Konkret)'] = document.getElementById('feinziel1').value;
            formData['Feinziel 2 (Aktion & Strategie)'] = document.getElementById('feinziel2').value;
            formData['Feinziel 3 (optional)'] = document.getElementById('feinziel3').value;
            formData['Ressourcen/Unterstützung'] = document.getElementById('ressourcen').value;
            formData['Überprüfungsdatum'] = document.getElementById('ueberpruefungsdatum').value;

            generatePDF(formData, 'download');
        }

        function printFormPDF() {
            const form = document.getElementById('zielvereinbarungForm');
            let formData = {};
            const checkboxes = [];

            formData['Teilnehmer/in'] = document.getElementById('teilnehmerName').value;
            formData['Datum'] = document.getElementById('datum').value;

            vorlageData.formFields[0].checkboxes.forEach((checkbox, index) => {
                if (document.getElementById(`problembereich${index}`).checked) {
                    checkboxes.push(checkbox.replace('[]', ''));
                }
            });
            formData['Problembereich'] = checkboxes.join(', ');
            formData['Problembeschreibung'] = document.getElementById('problemBeschreibung').value;
            formData['Grobziel'] = document.getElementById('grobziel').value;
            formData['Feinziel 1 (Messbar & Konkret)'] = document.getElementById('feinziel1').value;
            formData['Feinziel 2 (Aktion & Strategie)'] = document.getElementById('feinziel2').value;
            formData['Feinziel 3 (optional)'] = document.getElementById('feinziel3').value;
            formData['Ressourcen/Unterstützung'] = document.getElementById('ressourcen').value;
            formData['Überprüfungsdatum'] = document.getElementById('ueberpruefungsdatum').value;

            generatePDF(formData, 'print');
        }


        function generatePDF(formData, action = 'download') {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            let yPosition = 20;
            const margin = 20;
            const lineHeight = 10;

            doc.setFontSize(18);
            doc.text("Zielvereinbarungsformular", margin, yPosition);
            yPosition += 20;
            doc.setFontSize(12);

            for (const key in formData) {
                if (formData.hasOwnProperty(key)) {
                    doc.setFont('helvetica', 'bold');
                    doc.text(`${key}:`, margin, yPosition);
                    doc.setFont('helvetica', 'normal');
                    let value = formData[key];
                    if (!value) value = "-"; // Display "-" if value is empty
                    const textLines = doc.splitTextToSize(value, 180); // 180mm width for A4 less margins
                    textLines.forEach(line => {
                        yPosition += lineHeight;
                        doc.text(line, margin + 20, yPosition); // Indent value
                    });
                    yPosition += lineHeight; // Add extra space after each field
                }
                if (yPosition > 250) { // Check if content exceeds page height (adjust 250 based on your needs)
                    doc.addPage();
                    yPosition = 20; // Reset yPosition for new page
                }
            }

            if (action === 'download') {
                doc.save('zielvereinbarung_formular.pdf');
            } else if (action === 'print') {
                doc.output('dataurlnewwindow');
            }
        }


        // Initialisierung
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // Lade alle Daten initial (außer für beispiel vorlage)
                await loadAllData();

                // Initialisiere die Druck-Buttons auf der Hauptseite
                initializePrintButtons();

                // Lade den Standardinhalt
                navigateTo('leitfaden', 'einfuehrung'); // Zeigt standardmäßig Einführung

                // Zeige einen Erfolgsstatus
                showToast('success', 'Daten erfolgreich geladen');
            } catch (error) {
                console.error('Fehler bei der Initialisierung:', error);
                showToast('error', 'Fehler beim Laden der Anwendung');
            }
        });

        // Fallback für fehlendes Logo
        document.querySelector('.logo-image').onerror = function() {
            console.error('Logo konnte nicht geladen werden');

            // Alternative CDN-Format als erster Fallback
            const alternativeUrl = "https://cdn.jsdelivr.net/gh/Thimeus/BBB/logo_bbb_1.png";
            if (this.src !== alternativeUrl) {
                console.log('Versuche alternatives jsDelivr URL-Format...');
                this.src = alternativeUrl;
                return;
            }

            // Wenn beide CDN-Ansätze fehlschlagen, verwende textbasierten Fallback
            const logoContainer = document.querySelector('.logo-container');
            logoContainer.innerHTML = `
                <div style="display: flex; flex-direction: column;">
                    <div>
                        <span style="color: var(--primary-color); font-size: 24px; font-weight: bold;">BERUFLICHE</span>
                        <span style="color: var(--accent-color); font-size: 24px; font-weight: bold;"> BILDUNG</span>
                    </div>
                    <div style="color: var(--primary-color); font-size: 14px; letter-spacing: 2px;">BREMERHAVEN</div>
                </div>
            `;
        };
    </script>
</body>
</html>